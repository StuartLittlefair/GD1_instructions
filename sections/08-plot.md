# Visualising results 

The final challenge in the project is to replicate, or improve upon, Figure 1 in the paper "[Off the beaten path: Gaia reveals GD-1 stars outside of the main stream](https://arxiv.org/abs/1805.00425)" by Adrian Price-Whelan and Ana Bonaca.

We will need to think about the following issues.

- What elements make a compelling visualization that authentically reports scientific results ready for scientific presentation and publication?
- What tools and techinques are available to save time on creating presentation and publication-ready figures?

```{exercise}
#### Exercise (10 minutes)

Look at Figure 1 of the paper and think about the following questions:

1. What is the primary scientific result of this work?

2. What story is this figure telling?

3. In the design of this figure, can you identify 1 or 2 choices the
  authors made that you think are effective?  Think about big-picture
  elements, like the number of panels and how they are arranged, as well
  as details like the choice of typeface.

4. Can you identify 1 or 2 elements that could be improved, or that you
  might have done differently?
```

```{exercise}
#### Final Exercise

Make a version of Figure 1, using your own design choices. You may use any and all of the tips below. 

You can look inside `/content/drive/Shareddrives/ClassroomShared/MPS216/GD1/episode_functions.py` for versions of all the functions we have defined so far.
```

### Complex Layouts

Plots with lots of subplots can benefit from using [`subplot_mosaic`](https://matplotlib.org/stable/users/explain/axes/mosaic.html)

### Annotations

- To draw vertical lines, see [`plt.vlines`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.vlines.html) and [`plt.axvline`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.axvline.html).

- To add text, see [`plt.text`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.text.html).

- To add an annotation with text and an arrow, see [`plt.annotate`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.annotate.html).

Here is some [additional information about text and arrows](https://matplotlib.org/stable/tutorials/text/annotations.html).


### Customization

Matplotlib provides a default style that determines things like the colors of lines, the placement of labels and ticks on the axes, and many other properties.

There are several ways to override these defaults and customize your figures:

- To customize only the current figure, you can call functions like `tick_params`, which we will demonstrate below.

- To customize all figures in a notebook, you can use `rcParams`.

- To override more than a few defaults at the same time, you can use a style sheet.

As a simple example, notice that Matplotlib puts ticks on the outside of the figures by default, and only on the left and bottom sides of the axes.

#### rcParams

If you want to make a customization that applies to all figures in a notebook, you can use `rcParams`. When you import Matplotlib, a dictionary is created with default values for everything you can change about your plot. This is what you are overriding with `tick_params` above.

Here is an example that reads the current font size from `rcParams`:

```{code-cell} python
plt.rcParams['font.size']
```

```output
10.0
```

And sets it to a new value:

```{code-cell} python
plt.rcParams['font.size'] = 14
```

## Style sheets

It is possible that you would like multiple sets of defaults, for example, one default for plots for scientific papers and another for talks or posters. Because the `matplotlibrc` file is read when you import Matplotlib, it is not easy to switch from one set of options to another.

The solution to this problem is style sheets, [which you can read about here](https://matplotlib.org/stable/tutorials/introductory/customizing.html).

Matplotlib provides a set of predefined style sheets, or you can make your own. The [style sheets reference](https://matplotlib.org/stable/gallery/style_sheets/style_sheets_reference.html) shows a gallery of plots generated by common style sheets.

You can display a list of style sheets installed on your system.

```{code-cell} python
plt.style.available
```

```output
['Solarize_Light2',
 '_classic_test_patch',
 'bmh',
 'classic',
 'dark_background',
 'fast',
 'fivethirtyeight',
 'ggplot',
 'grayscale',
 'seaborn',
 'seaborn-bright',
[Output truncated]
```

Note that `seaborn-paper`, `seaborn-talk` and `seaborn-poster` are particularly intended to prepare versions of a figure with text sizes and other features that work well in papers, talks, and posters.

To use any of these style sheets, run `plt.style.use` like this:

```{code-cell} python
plt.style.use('fivethirtyeight')
```

The style sheet you choose will affect the appearance of all figures you plot after calling `use`, unless you override any of the options or call `use` again.

To switch back to the default style use

```{code-cell} python
plt.style.use('default')
```

If you cannot find a style sheet that is exactly what you want, you can make your own.  This project includes a style sheet called `az-paper-twocol.mplstyle`, with customizations chosen by Azalee Bostroem for publication in astronomy journals.

You can use it like this:

```{code-cell} python
plt.style.use('/content/drive/Shareddrives/ClassroomShared/MPS216/GD1/az-paper-twocol.mplstyle')
```

#### Adding the shaded regions

You will want to add the shaded regions showing the stars selected by proper motion and around the isochrone in the color magnitude diagram.

In episode 4 we defined a rectangle in proper motion space around the stars in GD-1. We stored the x-values of the vertices of this rectangle in `pm1_rect` and the y-values as `pm2_rect`.

To plot these regions, we will use the Matplotlib `Polygon` object.

To create a `Polygon`, we have to put the coordinates of the rectangle in an array with `x` values in the first column and `y` values in the second column.

```{code-cell} python
vertices = np.transpose([pm1_rect, pm2_rect])
vertices
```

```output
array([[-8.9, -2.2],
       [-8.9,  1. ],
       [-6.9,  1. ],
       [-6.9, -2.2]])
```

We will now create the `Polygon`, specifying its display properties which will be used when it is plotted. We will specify `closed=True` to make sure the shape is closed, `facecolor='orange` to color the inside of the `Polygon` orange, and `alpha=0.4` to make the `Polygon` semi-transparent.

```{code-cell} python
poly = Polygon(vertices, closed=True, 
                   facecolor='orange', alpha=0.4)
```

Then to plot the `Polygon` we call the `add_patch` method. `add_patch` like `tick_params` must be called on an `axes` or `subplot` object, so we will create a `subplot` and then add the `Patch` to the `subplot`.

```{code-cell} python
fig = plt.figure()
ax = fig.add_subplot(1,1,1)
poly = Polygon(vertices, closed=True, 
                   facecolor='orange', alpha=0.4)
ax.add_patch(poly)
ax.set_xlim(-10, 7.5)
ax.set_ylim(-10, 10)
```

```output
<Figure size 900x450 with 4 Axes>
```

![An orange rectangle at the coordinates used to select stars based on proper motion.](fig/08-plot_files/08-poly_example.png)

We can now call our plot\_proper\_motion function to plot the
proper motion for each star, and the add a shaded `Polygon` to show the
region we selected.

```{code-cell} python
fig = plt.figure()
ax = fig.add_subplot(1,1,1)
plot_proper_motion(centerline_df)
poly = Polygon(vertices, closed=True, 
               facecolor='C1', alpha=0.4)
ax.add_patch(poly)
```

```output
<Figure size 900x450 with 4 Axes>
```

![Proper motion with overlaid polygon showing our selected stars.](fig/08-plot_files/08-plot_53_0.png)